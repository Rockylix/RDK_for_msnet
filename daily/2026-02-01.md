# 2026-02-01 工作日志

## 📋 项目：RDK双摄像头实时显示

### 摘要
实现了基于RDK开发板的双摄像头实时图像采集与SSH X11转发显示功能。通过硬件VIO接口配置MIPI摄像头,集成OpenCV进行图像处理,最终实现640×480分辨率的双路实时显示。

### 详细技术路径

#### 1. VIO摄像头配置与图像采集 (commit: 9d73031)
- **配置参数**: 
  - 分辨率: 1920×1080
  - 位深: 16bit
- **文件**: `capture/capture_dis.cpp`, `capture/Makefile`
- **成果**: 成功采集并保存测试图像

#### 2. OpenCV集成与SSH X11转发实时显示
- **实现方案**:
  - 将C代码改为C++,在Makefile中链接OpenCV4库
  - 使用`sp_vio_get_yuv()`获取NV12格式图像
  - 通过`cvtColor()`转换为BGR格式
  - 使用`imshow()`实现SSH X11转发显示

#### 3. VPS硬件编码尝试 ❌
- **目标**: 利用板载VPS进行编码和缩放,减少CPU占用
- **问题**: 
  - 使用VPS处理后`get_frame`失败
  - 两张图片分辨率相同导致VPS流ID冲突
  - ISP处理完成但数据无法到达VPS进行缩放
- **决策**: 放弃VPS方案,改用Sensor直接降分辨率

#### 4. Sensor降分辨率方案 ✅
- **实现**:
  - 修改sensor配置,直接输出640×480图像
  - 取消OpenCV的resize操作
- **性能测试**:
  - 关闭imshow: FPS = 30 (达到摄像头极限帧率)
  - 开启SSH X11转发: FPS = 4~5
  - YUV→BGR转换: 对帧率影响极小

#### 5. 最终解决方案
- **双路输出策略**:
  - 第一路: 640×480 (用于后续处理,待缩放)
  - 第二路: 320×240 (用于SSH显示)
- **性能**: 保持30FPS稳定输出

### 参数记录

| 指标 | 数值 |
|------|------|
| 摄像头分辨率 | 1920×1080 → 640×480 |
| 显示分辨率 | 320×240 |
| 极限帧率 | 30 FPS |
| SSH转发帧率 | 4~5 FPS |
| YUV转BGR耗时 | 忽略不计 |

### 遗留问题

1. **SSH X11转发性能瓶颈**: 远程显示占用大量CPU资源,严重影响帧率
2. **VPS硬件加速未实现**: 流ID冲突问题未解决,无法利用硬件加速

### Git 提交记录
- `9d730316` - modules (初始提交,包含主要代码)
- `a8a84743` - Rename LOG.md to README.md
